<!DOCTYPE html>
<html>
<head>
<meta charset="EUC-KR">
<title>Insert title here</title>
<!-- Bootstrap Core CSS -->
<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet" id="bootstrap-css">    
<!-- Custom CSS -->
<link href="css/stylish-portfolio.css?ver=1" rel="stylesheet">
<!-- Custom Fonts -->
<link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">
<!-- jQuery -->
<script src="js/jquery.js"></script>
<!-- Bootstrap Core JavaScript -->
<script src="js/bootstrap.min.js"></script>  
<script src="http://code.jquery.com/jquery-1.10.2.js"></script>


<style type="text/css">
body,html {
    display: table;
    position: relative;
    width: 100%;
    height: 100%;
    background: url(img/iframe03_bg.jpg) no-repeat center center scroll;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    background-size: cover;
    -o-background-size: cover;
    color:white;
}

img{
background: url(img/card02.jpg) no-repeat center center scroll;
background-size: 100% 100%;
border : 0;
border-color: rgba(255,255,255,0);
outline : 0;
width: 250px;
height: 330px;
transform-style: preserve-3d;
position:absolute;
margin : auto 0;
border-radius: 10%;
}

img#pos1{
background: url(img/card01.jpg) no-repeat center center scroll;
background-size: 100% 100%;
border : 0;
border-color: rgba(255,255,255,0);
outline : 0;
width: 250px;
height: 330px;
transform-style: preserve-3d;
position:absolute;
margin : auto 0;
border-radius: 10%;
}

div{
border : 0;
border-color: rgba(255,255,255,0);
outline : 0;
}

#pos0{
transform:translate(30%,30%);
}

#pos1{
transform:translate(180%,30%);
}

#pos2{
transform:translate(330%,30%);
}


@keyframes move0_0{0% {transform:translate(30%,30%) rotateY(0deg);}
100% {transform:translate(30%,30%) rotateY(360deg);}}

@keyframes move0_1{0% {transform:translate(30%,30%);}
100% {transform:translate(180%,30%);}}

@keyframes move0_2{from {transform:translate(30%,30%);}
50%{transform: translate(180%,0%);}
to {  transform:translate(330%,30%);}}

@keyframes move1_0{0% {transform:translate(180%,30%);}
50%{transform: translate(105%,70%);}
100% {transform:translate(30%,30%);}}

@keyframes move1_1{0% {transform:translate(180%,30%) rotateY(0deg);}
100% {transform:translate(180%,30%) rotateY(360deg);}}

@keyframes move1_2{0% {transform:translate(180%,30%);}
100% {transform:translate(330%,30%);}}

@keyframes move2_0{0% {transform:translate(330%,30%);}
50%{transform: translate(180%,90%);}
100% {transform:translate(30%,30%);}}

@keyframes move2_1{0% {transform:translate(330%,30%);}
50%{transform: translate(255%,70%);}
100% {transform:translate(180%,30%);}}

@keyframes move2_2{0% {transform:translate(330%,30%) rotateY(0deg);}
100% {transform:translate(330%,30%) rotateY(360deg);}}

.rotate{
	background-color : blue !important;
}

body,html{width:100%;height:100%;}


.inside{
	float:left;
	margin-left : 20%;
	margin-top : 15%;
	
}

.bottom{
	
	margin-left : 49%;
	margin-top : 40%;
}

.myColor{
	color : black;
}


</style>







<script type="text/javascript">
var X_array_1 = new Array(3);
X_array_1 = ["img/card02.jpg","img/card02_ans.jpg","img/card02.jpg"];
var ran;
var ran_a = new Array;
var buffer;
var k=0;
var myplay;
var answer;



$(document).ready(function(){
	var i=0;	
	do{
		ran = Math.floor(Math.random() * X_array_1.length);
		if(ran != ran_a[i-1]){
			ran_a[i] = ran;
			i++;
			}
		}
	while(ran_a.length<10)		
		});




function main_pjt(){
	
	
	// 수정해줘야함 DCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDCDC
	setTimeout(function(){
		input_src(X_array_1[0],X_array_1[1],X_array_1[2]);	
		myplay = setInterval(function(){ myTimer() }, 1010);
	},3000)

	
}
function myTimer() {
	input_src(X_array_1[0],X_array_1[1],X_array_1[2]);
	ani(ran_a[k]);
	swap_val(ran_a[k]);	
	k++;
	if(k==8){
		clearInterval(myplay);
		console.log(X_array_1[0]);
		console.log(X_array_1[1]);
		console.log(X_array_1[2]);
	}
}
function myStopFunction() {
    clearInterval(myplay);
}


	
function ani(i){
	if(i == 0){
		$("#pos0").css("animation","move0_0 1s linear forwards");
		$("#pos1").css("animation","move1_2 1s linear forwards");
		$("#pos2").css("animation","move2_1 1s linear forwards");
		}
	else if(i == 1){
		$("#pos0").css("animation","move0_2 1s linear forwards");
		$("#pos1").css("animation","move1_1 1s linear forwards");
		$("#pos2").css("animation","move2_0 1s linear forwards");
		}
	else if(i == 2){
		$("#pos0").css("animation","move0_1 1s linear forwards");
		$("#pos1").css("animation","move1_0 1s linear forwards");
		$("#pos2").css("animation","move2_2 1s linear forwards");
		}
}

function swap_val(i){
	if(i==0){
		buffer = X_array_1[1];
		X_array_1[1] = X_array_1[2];
		X_array_1[2] = buffer;
		}
	else if(i==1){
		buffer = X_array_1[0];
		X_array_1[0] = X_array_1[2];
		X_array_1[2] = buffer;
		}
	else if(i==2){
		buffer = X_array_1[0];
		X_array_1[0] = X_array_1[1];
		X_array_1[1] = buffer;
		}	
}
	
	
		

function input_src(x,y,z){
	$("#pos0").attr("src", x);
	$("#pos1").attr("src", y);
	$("#pos2").attr("src", z);
}

</script>
</head>
<body>


		

		
<!-- 	b1:ready+정답을 보내기
		b2:finish
		b3:애니메이션 구동하기
		

 -->
		
		<div class="inside">		
		<img class="ani" id="pos0" ></img>
		<img class="ani" id="pos1"></img>
		<img class="ani" id="pos2"></img>
		</div>
		
		<div class="bottom">
		<div class="container">
			<div class="row">				
				<h3 data-toggle="modal" href="#myModal" id="id">Controller</h3>
				<div class="modal hide" id="myModal">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">x</button>
						<h3 class="myColor" align="center">Controller</h3>
					</div>			         
					<div class="modal-body myColor noscroll" align="center">
						<a class="btn btn-primary" onclick="main_pjt();">Play</a><input type="hidden" id="g1" value="Three Card Monte"/>
						<a class="btn btn-primary" onclick="ready_g1();">Betting Start</a>
			    		<a class="btn btn-primary" onclick="finish_g1();">Finish</a> 						
					</div>
				</div>
			</div>
		</div>
		</div>

</body>
<script>

//var webSocket = new WebSocket("ws://localhost:8181/Z_study/server_ws");
var webSocket1 = new WebSocket("ws://localhost:6080/semi02_2/server_ws");
var webSocket2 = new WebSocket("ws://localhost:6080/semi02_2/broadcast");

webSocket1.onopen = function(message){
    console.log("Server1 connect...\n");
};

webSocket2.onopen = function(message){        	
    console.log("Server2 connect...\n");
};

function ready_g1(){
	if(X_array_1[0] == "img/card02_ans.jpg"){
		answer = 0;
		}		
	else if(X_array_1[1] == "img/card02_ans.jpg"){
		answer = 1;
		}
	else if(X_array_1[2] == "img/card02_ans.jpg"){
		answer = 2;
		}
	webSocket1.send(answer);
	console.log(answer);
	
	webSocket2.send($("#g1").val()+" 배팅 시작"+"\n");
	console.log($("#g1").val()+"배팅시작"+"\n");
	return false;
}

function finish_g1(){	
	webSocket2.send($("#g1").val()+" 끝"+"\n");
	console.log($("#g1").val()+"끝"+"\n");
	return false;
}


function send_answer(){
	
	
}
function check_val(){	
	for(var i=0;i<ran_a.length;i++)
	console.log(ran_a[i]);
	}	




/*

$(document).keypress(function(event){
    var keycode = (event.keyCode ? event.keyCode : event.which);
    if(keycode == '13'){
    	webSocket2.send($("#notice").val()+"\n");
    	$("#notice").val("");  
    }
});


	





*/


</script>
</html>